<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">


<!-- html generated by pub-server from markdown /013 Configuration.md -->

<title>Configuration</title>
<link rel="stylesheet" href="./css/github-markdown.css">
<link rel="stylesheet" href="./css/pub-theme-doc.css">
<link rel="stylesheet" href="./css/prism.css">
<link rel="stylesheet" href="./css/font-awesome.css">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>

<div data-render-layout="main-layout">
<header>
<div id="doctitle"><h1 id="pub-server"><a href="./">pub-server</a></h1>
<p>documentation</p>
</div>
<div id="topmenu"><ul>
<li><a href="https://github.com/jldec/pub-server" title="github"><span class="fa fa-lg fa-fw">&#xf09b;</span></a></li>
</ul>
</div>
</header>

<div id="navicon" onclick=""><p><span class="fa fa-fw fa-lg">&#xf0c9;</span></p>

<nav id="toc">
<ul>
<li><a href="./">Introduction</a></li>
<li><a href="./how-it-works">How it works</a></li>
<li><a href="./installation">Installation</a></li>
<li><a href="./simple-doc-site">Simple doc site</a></li>
<li><a href="./configuration">Configuration</a></li>
<li><a href="./packages-and-themes">Packages and Themes</a></li>
<li><a href="./sources">Sources</a></li>
<li><a href="./outputs">Outputs</a></li>
<li><a href="./static-files">Static Files</a></li>
<li><a href="./browser-scripts">Browser Scripts</a></li>
<li><a href="./generator-plugins">Generator Plugins</a></li>
<li><a href="./server-plugins">Server Plugins</a></li>
<li><a href="./web-server-configuration">Web Server Configuration</a></li>
<li><a href="./the-page-model">The Page Model</a></li>
<li><a href="./links">Links</a></li>
<li><a href="./command-line">Command line</a></li>
<li><a href="./helpers">Helpers</a></li>
<li><a href="./github-pages">GitHub Pages</a></li>
</ul>
</nav>
</div>

<div id="main" onclick="">
<div id="content" class="markdown-body">
<div data-render-page="/configuration">
<div data-render-html="/configuration"><h1 id="configuration-with-pub-config">Configuration with <code>pub-config</code></h1>
<p>By adding a <code>pub-config</code> file to a directory, you can control how pub-server processes files, rather than depending on defaults or command-line options. The <code>pub-config</code> for this documentation lives <a href="https://github.com/jldec/pub-doc/blob/master/pub-config.js">here</a>.</p>
<p>A directory with a <code>pub-config</code> can also be packaged as a pub-server package or theme and distributed via npm, making it available for re-use in other projects.</p>
<h3 id="options-structure">options structure</h3>
<p><code>pub-config</code> exports a single javascript options object. The main path options keys are listed below and each is documented on a separate page</p>
<ul>
<li><code>pkgs:</code> <a href="./packages-and-themes">Packages and Themes</a></li>
<li><code>sources:</code> Paths to <a href="./sources">Sources</a></li>
<li><code>outputs:</code> Paths to <a href="./outputs">Outputs</a></li>
<li><code>staticPaths:</code> Paths to <a href="./static-files">Static Files</a></li>
<li><code>browserScripts:</code> Generating <a href="./browser-scripts">Browser Scripts</a></li>
<li><code>generatorPlugins:</code> <a href="./generator-plugins">Generator Plugins</a></li>
<li><code>serverPlugins:</code> <a href="./server-plugins">Server Plugins</a></li>
</ul>
<p>Besides the main path options, the following core server and generator options are recognized.</p>
<pre><code class="language-js">opts<span class="token punctuation">.</span>production     <span class="token comment">// boolean (process.env.NODE_ENV === 'production')</span>
opts<span class="token punctuation">.</span>port           <span class="token comment">// override port (process.env.PORT || '3001')</span>
opts<span class="token punctuation">.</span>appUrl         <span class="token comment">// string - qualify URLs (process.env.APP)</span>
opts<span class="token punctuation">.</span>linkNewWindow  <span class="token comment">// boolean - add target="_blank" to external links</span>
opts<span class="token punctuation">.</span>allowSpacesInLinks <span class="token comment">// boolean - allows markdown links with spaces (e.g. form input names with spaces)</span></code></pre>
<p>Additional options may be available depending on the active theme e.g for adding links to GitHub and copyright notices.</p>
<h3 id="json-or-javascript">JSON or JavaScript</h3>
<p>You have the choice of using either a .json or .js file for configuration.</p>
<p>If you use a .js file, export the options object using <code>module.exports</code>. The following example shows how to generate different config options using environment variables.</p>
<pre><code class="language-js"><span class="token keyword">var</span> opts <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

opts<span class="token punctuation">.</span>cloud       <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CLOUD</span><span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>auth        <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">AUTH</span><span class="token punctuation">;</span>

opts<span class="token punctuation">.</span>pkgs        <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'pub-pkg-seo'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>auth<span class="token punctuation">)</span> <span class="token punctuation">{</span> opts<span class="token punctuation">.</span>pkgs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'pub-pkg-google-oauth'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

opts<span class="token punctuation">.</span>sources     <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>staticPaths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>outputs     <span class="token operator">=</span> opts<span class="token punctuation">.</span>cloud <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<p>The syntax for .json is stricter, and it is not possible to include conditional logic, but json is easier to manipulate and re-serialize. No explicit <code>export</code> is required for json files.</p>
<h5 id="canonical-path-options-format">Canonical path options format</h5>
<p>Path options (all the keys above) can be either strings or objects and single-values or arrays. Objects are required if one path has additional properties. Arrays are required when there are multiple paths. The following are equivalent.</p>
<pre><code class="language-js">sources<span class="token operator">:</span> <span class="token string">'./markdown'</span>
sources<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./markdown'</span><span class="token punctuation">]</span>
sources<span class="token operator">:</span> <span class="token punctuation">{</span> path<span class="token operator">:</span><span class="token string">'./markdown'</span> <span class="token punctuation">}</span>
sources<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> path<span class="token operator">:</span><span class="token string">'./markdown'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span></code></pre>
<h3 id="inspecting-the-config">Inspecting the config</h3>
<p>To inspect the fully resolved options while pub-server is running, browse to <code>/admin/opts</code>.</p>
<p><code>pub -C</code> will present a similar result on the command line.</p>
</div>

</div><!--page-->
</div>
<div id="credit"><p><span class="fa">&#xf004;</span> powered by <a href="https://jldec.github.io/pub-doc/">pub-server</a> and <a href="https://github.com/jldec/pub-theme-doc">pub-theme-doc</a></p>
</div>
</div>

</div><!--layout-->

<script>window.pubRef = {"href":"/configuration","relPath":"."};</script>
<script src="./js/jquery-1.12.4.min.js" ></script>
<script src="./pub/pub-ux.js" ></script>
<!-- Copyright (c) 2015-2020 JÃ¼rgen Leschner - github.com/jldec - MIT license -->
</body>
</html>
