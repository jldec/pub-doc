<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">


<!-- html generated by pub-server from markdown /019 Generator Plugins.md -->

<title>Generator Plugins</title>
<link rel="stylesheet" href="./css/github-markdown.css">
<link rel="stylesheet" href="./css/pub-theme-doc.css">
<link rel="stylesheet" href="./css/prism.css">
<link rel="stylesheet" href="./css/font-awesome.css">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>

<div data-render-layout="main-layout"><header>
<div id="doctitle"><h1 id="pub-server"><a href="./">pub-server</a></h1>
<p>documentation</p>
</div>
<div id="topmenu"><ul>
<li><a href="https://github.com/jldec/pub-server" title="github"><span class="fa fa-lg fa-fw">&#xf09b;</span></a></li>
</ul>
</div>
</header>

<div id="navicon" onclick=""><p><span class="fa fa-fw fa-lg">&#xf0c9;</span></p>

<nav id="toc">
<ul>
<li><a href="./">Introduction</a></li>
<li><a href="./how-it-works">How it works</a></li>
<li><a href="./installation">Installation</a></li>
<li><a href="./simple-doc-site">Simple doc site</a></li>
<li><a href="./configuration">Configuration</a></li>
<li><a href="./packages-and-themes">Packages and Themes</a></li>
<li><a href="./sources">Sources</a></li>
<li><a href="./outputs">Outputs</a></li>
<li><a href="./static-files">Static Files</a></li>
<li><a href="./browser-scripts">Browser Scripts</a></li>
<li><a href="./generator-plugins">Generator Plugins</a></li>
<li><a href="./server-plugins">Server Plugins</a></li>
<li><a href="./web-server-configuration">Web Server Configuration</a></li>
<li><a href="./the-page-model">The Page Model</a></li>
<li><a href="./links">Links</a></li>
<li><a href="./command-line">Command line</a></li>
<li><a href="./helpers">Helpers</a></li>
<li><a href="./github-pages">GitHub Pages</a></li>
</ul>
</nav>
</div>

<div id="main" onclick="">
<div id="content" class="markdown-body">
<div data-render-page="default"><div data-render-html="/generator-plugins"><h1 id="generator-plugins">Generator Plugins</h1>
<p>Many pub-server packages rely on generator plugins, usually to provide specialized handlebars helpers.</p>
<p>Generator plugins are &quot;universal&quot; npm modules. They run in node.js, as well as in browsers.</p>
<p>Here is the <code>pub-config</code> entry from <a href="https://github.com/jldec/pub-theme-doc">pub-theme-doc</a>.</p>
<pre><code class="language-js">generatorPlugins<span class="token operator">:</span> <span class="token string">'./plugins/generator-plugin.js'</span><span class="token punctuation">,</span></code></pre>
<p>The file path follows the node.js <code>require(path)</code> convention of using relative paths for modules which are local files and bare names for installable npm modules.</p>
<p>Here is the <a href="https://github.com/jldec/pub-theme-doc/blob/master/plugins/generator-plugin.js">plugin</a>:</p>
<pre><code class="language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">var</span> u <span class="token operator">=</span> generator<span class="token punctuation">.</span>util<span class="token punctuation">;</span>
  <span class="token keyword">var</span> opts <span class="token operator">=</span> generator<span class="token punctuation">.</span>opts<span class="token punctuation">;</span>
  <span class="token keyword">var</span> hb <span class="token operator">=</span> generator<span class="token punctuation">.</span>handlebars<span class="token punctuation">;</span>

  hb<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">'navIcon'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">frame</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">return</span> hb<span class="token punctuation">.</span><span class="token function">defaultFragmentHtml</span><span class="token punctuation">(</span><span class="token string">'/#navicon'</span><span class="token punctuation">,</span>
      <span class="token string">'_!bars fw lg_'</span><span class="token punctuation">,</span>
      <span class="token string">'&lt;span class="icon">=&lt;/span>'</span><span class="token punctuation">,</span>
      frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  hb<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">'docTitle'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">frame</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> title <span class="token operator">=</span> opts<span class="token punctuation">.</span>docTitle <span class="token operator">||</span> opts<span class="token punctuation">.</span>pkgName <span class="token operator">||</span> <span class="token string">'pub-server'</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> subTitle <span class="token operator">=</span> opts<span class="token punctuation">.</span>docSubTitle <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> hb<span class="token punctuation">.</span><span class="token function">defaultFragmentHtml</span><span class="token punctuation">(</span><span class="token string">'/#doctitle'</span><span class="token punctuation">,</span>
      <span class="token string">'# ['</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">'](/)\n'</span> <span class="token operator">+</span> subTitle<span class="token punctuation">,</span>
      <span class="token string">'&lt;h1>&lt;a href="/">'</span> <span class="token operator">+</span> u<span class="token punctuation">.</span><span class="token function">escape</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;/a>&lt;/h1>'</span> <span class="token operator">+</span> subTitle<span class="token punctuation">,</span>
      frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  hb<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">'topMenu'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">frame</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> url <span class="token operator">=</span> opts<span class="token punctuation">.</span>github <span class="token operator">||</span> hb<span class="token punctuation">.</span><span class="token function">githubUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> hb<span class="token punctuation">.</span><span class="token function">defaultFragmentHtml</span><span class="token punctuation">(</span><span class="token string">'/#topmenu'</span><span class="token punctuation">,</span>
      url <span class="token operator">?</span> <span class="token string">'- [_!github lg fw_]('</span> <span class="token operator">+</span> url <span class="token operator">+</span> <span class="token string">' "github")'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      url <span class="token operator">?</span> <span class="token string">'&lt;ul>&lt;li>&lt;a href="'</span> <span class="token operator">+</span> url <span class="token operator">+</span> <span class="token string">'">github&lt;/a>&lt;/li>&lt;/ul>'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre>
<p>Generator plugins are expected to export a single function which is called once at startup. The function is passed a single <code>generator</code> parameter which is an instance of <code>pub-generator</code>.</p>
<h3 id="registering-helpers">Registering helpers</h3>
<p>Plugins can register new helpers using the handlebars instance at <code>generator.handlebars</code>.</p>
<p>An interesting example is the generator plugin in <a href="https://github.com/jldec/pub-pkg-font-awesome">pub-pkg-font-awesome</a> which, besides registering some helpers, also adds a plugin to <code>generator.marked</code> to extend the markdown syntax for emphasis/italics.</p>
<h3 id="manipulating-the-generator-page-model">Manipulating the generator page model</h3>
<p>Plugins which need to manipulate the page content model after it has been loaded from source, can do so by hooking into a &#39;pages-ready&#39; event emitted by the generator after loading source files and parsing all the markdown and templates</p>
<pre><code class="language-js">generator<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'pages-ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">decoratePages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Note that the <code>pages-ready</code> event will be triggered each time the server reloads sources e.g. when watching directories for changes.</p>
</div>
</div>
</div>
<div id="credit"><p><span class="fa">&#xf004;</span> powered by <a href="https://jldec.github.io/pub-doc/">pub-server</a> and <a href="https://github.com/jldec/pub-theme-doc">pub-theme-doc</a></p>
</div>
</div>
</div>

<script>window.pubRef = {"href":"/generator-plugins","relPath":"."};</script>
<script src="./js/jquery-1.12.4.min.js" ></script>
<script src="./pub/pub-ux.js" ></script>
<!-- Copyright (c) 2015-2020 Jürgen Leschner - github.com/jldec - MIT license -->
</body>
</html>
