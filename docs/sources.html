<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">


<!-- html generated by pub-server from markdown /015 Sources.md -->

<title>Sources</title>
<link rel="stylesheet" href="./css/github-markdown.css">
<link rel="stylesheet" href="./css/pub-theme-doc.css">
<link rel="stylesheet" href="./css/prism.css">
<link rel="stylesheet" href="./css/font-awesome.css">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>

<div data-render-layout="main-layout">
<header>
<div id="doctitle"><h1 id="pub-server"><a href="./">pub-server</a></h1>
<p>documentation</p>
</div>
<div id="topmenu"><ul>
<li><a href="https://github.com/jldec/pub-server" title="github"><span class="fa fa-lg fa-fw">&#xf09b;</span></a></li>
</ul>
</div>
</header>

<div id="navicon" onclick=""><p><span class="fa fa-fw fa-lg">&#xf0c9;</span></p>

<nav id="toc">
<ul>
<li><a href="./">Introduction</a></li>
<li><a href="./how-it-works">How it works</a></li>
<li><a href="./installation">Installation</a></li>
<li><a href="./simple-doc-site">Simple doc site</a></li>
<li><a href="./configuration">Configuration</a></li>
<li><a href="./packages-and-themes">Packages and Themes</a></li>
<li><a href="./sources">Sources</a></li>
<li><a href="./outputs">Outputs</a></li>
<li><a href="./static-files">Static Files</a></li>
<li><a href="./browser-scripts">Browser Scripts</a></li>
<li><a href="./generator-plugins">Generator Plugins</a></li>
<li><a href="./server-plugins">Server Plugins</a></li>
<li><a href="./web-server-configuration">Web Server Configuration</a></li>
<li><a href="./the-page-model">The Page Model</a></li>
<li><a href="./links">Links</a></li>
<li><a href="./command-line">Command line</a></li>
<li><a href="./helpers">Helpers</a></li>
<li><a href="./github-pages">GitHub Pages</a></li>
</ul>
</nav>
</div>

<div id="main" onclick="">
<div id="content" class="markdown-body">
<div data-render-page="/sources">
<div data-render-html="/sources"><h1 id="sources">Sources</h1>
<p><code>pub-server</code> uses content stored in sources to generate your site.</p>
<p>Most sources are directories in your project or inside a theme package. Source directories are scanned, and new files picked up automatically when the source is read.</p>
<p>File-system sources can be watched and automatically re-read when changes are detected.</p>
<h2 id="source-modules">Source modules</h2>
<p>In addition to the default file-system sources, pub-server supports pluggable npm modules which can read and write files from github, dropbox etc.</p>
<p>These are configured configuring <code>source.src</code> with the source module name E.g. &#39;pub-src-github&#39;.</p>
<p>The source API is able to glob directories recursively, and return an ordered set of files, optionally matching a glob pattern.</p>
<p>For more information see <a href="https://github.com/jldec/pub-src-fs">pub-src-fs</a> and
<a href="https://github.com/jldec/pub-src-github">pub-src-github</a></p>
<p><a href="https://github.com/jldec/pub-src-redis">pub-src-redis</a> can also serve as a cache for other sources.</p>
<p>Source modules are resolved and loaded by pub-resolve-opts at startup time.</p>
<h2 id="markdown-fragments">Markdown fragments</h2>
<p>pub-server content is maintained in markdown fragments inside files which originate in sources.</p>
<p>Fragments in the same file are separated by a delimiter like</p>
<pre><code>---- /page-1 ----
</code></pre>
<p>For an overview of why we use fragments see the blog post <a href="https://blog.pubblz.com/pub-server-fragments">pub-server Fragments</a>.</p>
<h2 id="handlebars-templates">Handlebars templates</h2>
<p>Handlebars templates are also just files (or fragments) in sources. For templates, pub-server looks an <code>.hbs</code> extension.</p>
<p>Templates are the key to separating HTML from content stored in markdown, making the content maintainable by non-developers.</p>
<p>pub-server compiles and invokes specific templates when it generates each page in a site. The templates use built-in <a href="./helpers">Helpers</a> to call javascript functions for things like page-variable interpolation and markdown rendering. Custom helpers can be defined using <a href="generator-plugins">Generator Plugins</a>.</p>
<h3 id="sample-config">Sample config</h3>
<p>The sample below is used in a complex environment to run locally and on a Heroku server for staging. The hosted server uses a redis cache and pulls sources from GitHub.</p>
<pre><code class="language-js"><span class="token keyword">var</span> ifLocal <span class="token operator">=</span> opts<span class="token punctuation">.</span>localhost<span class="token punctuation">;</span>
<span class="token keyword">var</span> ghTest  <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TEST_GH</span><span class="token punctuation">;</span>

opts<span class="token punctuation">.</span>sources <span class="token operator">=</span> <span class="token punctuation">[</span>

  <span class="token punctuation">{</span> name<span class="token operator">:</span>           <span class="token string">'markdown'</span><span class="token punctuation">,</span>
    src<span class="token operator">:</span>            <span class="token punctuation">(</span>ifLocal <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>ghTest<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'pub-src-fs'</span> <span class="token operator">:</span>    <span class="token string">'pub-src-github'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span>           <span class="token punctuation">(</span>ifLocal <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>ghTest<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'../&lt;repo>/md'</span>  <span class="token operator">:</span> <span class="token string">'/md'</span><span class="token punctuation">,</span>
    repo<span class="token operator">:</span>           <span class="token string">'...'</span><span class="token punctuation">,</span>     <span class="token comment">// for pub-src-github</span>
    glob<span class="token operator">:</span>           <span class="token string">'**/*.md'</span><span class="token punctuation">,</span>
    depth<span class="token operator">:</span>          <span class="token number">4</span><span class="token punctuation">,</span>
    cache<span class="token operator">:</span>          <span class="token punctuation">(</span>ifLocal <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">'pub-src-redis'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    leftDelim<span class="token operator">:</span>      <span class="token string">'----'</span><span class="token punctuation">,</span>
    rightDelim<span class="token operator">:</span>     <span class="token string">''</span><span class="token punctuation">,</span>
    headerDelim<span class="token operator">:</span>    <span class="token string">'----'</span><span class="token punctuation">,</span>
    slugify<span class="token operator">:</span>        <span class="token punctuation">{</span>allow<span class="token operator">:</span><span class="token string">'_'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    writable<span class="token operator">:</span>       <span class="token boolean">true</span><span class="token punctuation">,</span>
    fragmentDelim<span class="token operator">:</span>  <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token punctuation">{</span> name<span class="token operator">:</span>           <span class="token string">'templates'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span>           <span class="token string">'./templates'</span><span class="token punctuation">,</span>
    compile<span class="token operator">:</span>        <span class="token string">'handlebars'</span><span class="token punctuation">,</span>
    cache<span class="token operator">:</span>          ifLocal <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">'pub-src-redis'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token punctuation">{</span> name<span class="token operator">:</span>           <span class="token string">'schedule'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span>           <span class="token string">'...'</span><span class="token punctuation">,</span>
    src<span class="token operator">:</span>            <span class="token string">'pub-src-http'</span><span class="token punctuation">,</span>
    cache<span class="token operator">:</span>          <span class="token punctuation">(</span>ifLocal <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">'pub-src-redis'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    interval<span class="token operator">:</span>       <span class="token string">'20m'</span><span class="token punctuation">,</span>
    timeout<span class="token operator">:</span>        <span class="token string">'10s'</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span>           <span class="token string">'JSON'</span><span class="token punctuation">,</span>
    log<span class="token operator">:</span>            <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="notes">notes:</h4>
<ul>
<li><code>source.writable</code> is required for the editor to save files back to the source.</li>
<li><code>source.name</code> enables use of <code>generator.sourcePage$[name]</code> in helpers.</li>
<li><code>leftDelim</code>, <code>rightDelim</code>, <code>headerDelim</code> customizes fragment header syntax.</li>
<li>setting <code>source.compile</code> to &#39;handlebars&#39;` forces all fragments to be treated as handlebars templates, irrespective of extensions.</li>
<li>setting <code>source.type</code> to something other than &#39;FILE&#39; causes the source to be treated as an opaque JSON object instead of an array containing file objects.</li>
</ul>
</div>

</div><!--page-->
</div>
<div id="credit"><p><span class="fa">&#xf004;</span> powered by <a href="https://jldec.github.io/pub-doc/">pub-server</a> and <a href="https://github.com/jldec/pub-theme-doc">pub-theme-doc</a></p>
</div>
</div>

</div><!--layout-->

<script>window.pubRef = {"href":"/sources","relPath":"."};</script>
<script src="./js/jquery-1.12.4.min.js" ></script>
<script src="./pub/pub-ux.js" ></script>
<!-- Copyright (c) 2015-2020 Jürgen Leschner - github.com/jldec - MIT license -->
</body>
</html>
